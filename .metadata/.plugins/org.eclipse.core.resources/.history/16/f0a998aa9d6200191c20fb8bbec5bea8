package com.kjellvos.aletho;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.Scanner;

public class Main2 {
	static char[] alphabet = "abcdefghijklmnopqrstuvwxyz".toUpperCase().toCharArray();
	static HashMap<Character, Node> nodes = new HashMap<Character, Node>();
	static Worker[] workers = new Worker[5];
	
	public static void main(String[] args) throws FileNotFoundException {
		Scanner scanner = new Scanner(new File("input.txt"));  
		while (scanner.hasNextLine()) {
			String line = scanner.nextLine();
			char dependency = line.charAt(5);
			char identifier = line.charAt(36);
			
			if (nodes.containsKey(identifier)) {
				Node node = nodes.get(identifier);
				node.dependencies.add(dependency);
			}else { 
				nodes.put(identifier, new Node(identifier + 60));
				nodes.get(identifier).addToDependencies(dependency);
			}
			
			if (!nodes.containsKey(dependency)) {
				nodes.put(dependency, new Node(dependency + 60));
			}
		}
		scanner.close();
	
		//part 2
		for (int i = 0; i < 5; i++) {
			workers[i] = new Worker();
		}
		
		String output = "";
		while (nodes.size() > 0) {		
			for (int i = 0; i < workers.length; i++) {
				if (workers[i].timeLeft > 0) {
					workers[i].timeLeft--;
				}
			}
			for (int i = 0; i < alphabet.length; i++) {
				if (nodes.containsKey(alphabet[i])) {
					if (!nodes.get(alphabet[i]).blockedByDependencies()) {
						for (int j = 0; j < workers.length; j++) {
							if (workers[i].timeLeft == 0) {
								workers[i].stepCode = alphabet[i];
								workers[i].timeLeft = i + 60;
							}
						}
					}
				}
			}
			for (int i = 0; i < workers.length; i++) {
				if (workers[i].timeLeft == 0) {
					output += workers[i].stepCode;
				}
			}
		}
		System.out.println(output);
	}
}
